<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · TestParticle.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://henry2004y.github.io/TestParticle.jl/tutorial/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TestParticle.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../example/">Example</a></li><li><a class="tocitem" href="../api/">API</a></li><li class="is-active"><a class="tocitem" href>Tutorial</a><ul class="internal"><li><a class="tocitem" href="#Uniform-E-and-B-Fields"><span>Uniform E and B Fields</span></a></li><li><a class="tocitem" href="#Nonuniform-B-Field"><span>Nonuniform B Field</span></a></li><li><a class="tocitem" href="#Nonuniform-E-Field"><span>Nonuniform E Field</span></a></li><li><a class="tocitem" href="#Time-Varying-E-Field"><span>Time-Varying E Field</span></a></li><li><a class="tocitem" href="#Time-Varying-B-Field"><span>Time-Varying B Field</span></a></li><li><a class="tocitem" href="#Summary-of-Guiding-Center-Drifts"><span>Summary of Guiding Center Drifts</span></a></li><li><a class="tocitem" href="#Adiabatic-Invariants"><span>Adiabatic Invariants</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/henry2004y/TestParticle.jl/blob/master/docs/src/tutorial.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial"><a class="docs-heading-anchor" href="#Tutorial">Tutorial</a><a id="Tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial" title="Permalink"></a></h1><p>What makes plasmas particularly difficult to analyze is the fact that the densities fall in an intermediate range. Fluids like water are so dense that the motions of individual molecules do not have to be considered. Collisions dominate, and the simple equations of ordinaryy fluid dynamics suffice. At the other extreme in very low-density devices, only single-particle trajectories need to be considered; collective effects are often unimportant. Plasma behaves sometimes like fluids, and sometimes like a collection of individual particles. The first step in learning how to deal with this schizophrenic personality is to understand how single particles behave in electric and magnetic fields.</p><p>Here we assume that the EM fields are prescribed and not affected by the charged particles. The materials here closely follows F.F.Chen&#39;s <a href="https://link.springer.com/book/10.1007/978-3-319-22309-4">Introduction to Plasma Physics and Controlled Fusion</a>.</p><h2 id="Uniform-E-and-B-Fields"><a class="docs-heading-anchor" href="#Uniform-E-and-B-Fields">Uniform E and B Fields</a><a id="Uniform-E-and-B-Fields-1"></a><a class="docs-heading-anchor-permalink" href="#Uniform-E-and-B-Fields" title="Permalink"></a></h2><h3 id="E0"><a class="docs-heading-anchor" href="#E0">E=0</a><a id="E0-1"></a><a class="docs-heading-anchor-permalink" href="#E0" title="Permalink"></a></h3><p>In this case, a charged particle has a simple cyclotron gyration. The equation of motion is</p><p class="math-container">\[m\frac{d\mathbf{V}}{dt} = q\mathbf{V}\times\mathbf{B}\]</p><p>Taking <span>$\widehat{z}$</span> to be the direction of <span>$\mathbf{B}$</span> (<span>$\mathbf{B} = B\widehat{z}$</span>), we have</p><p class="math-container">\[\begin{aligned}
m\dot{v}_x = qB v_y,\, m\dot{v}_y = -qB v_x,\, m\dot{v}_z = 0, \\
\ddot{v}_x = \frac{qB}{m}\dot{v}_y = -\big( \frac{qB}{m}\big)^2 v_x \\
\ddot{v}_y = \frac{qB}{m}\dot{v}_x = -\big( \frac{qB}{m}\big)^2 v_y
\end{aligned}\]</p><p>This describes a simple harmonic oscillator at the <em>cyclotron frequency</em>, which we define to be</p><p class="math-container">\[\omega_c \equiv \frac{| q | B}{m}s\]</p><p>By the convention we have chosen, <span>$\omega_c$</span> is always nonnegative. The solution of velocity is then</p><p class="math-container">\[v_{x,y} = v_\perp \exp(\pm i \omega t + i\delta_{x,y})\]</p><p>The <span>$\pm$</span> denote the sign of q. We may choose the phase <span>$\delta$</span> so that</p><p class="math-container">\[v_x = v_\perp e^{i\omega_c t} = \dot{x}\]</p><p>where <span>$v_\perp$</span> is a positive constant denoting the speed in the plane perpendicular to <span>$\mathbf{B}$</span>. Then</p><p class="math-container">\[v_y  = \frac{m}{qB} \dot{v}_x = \pm \frac{1}{\omega_c}\dot{v}_x = \pm i v_\perp e^{i\omega_c t} = \dot{y}\]</p><p>Integrating once again, we have</p><p class="math-container">\[\begin{aligned}
x - x_0 = -i\frac{v_\perp}{\omega_c}e^{i\omega_c t} \\
y - y_0 = \pm i\frac{v_\perp}{\omega_c}e^{i\omega_c t}
\end{aligned}\]</p><p>We define the <em>Larmor radius</em> to be</p><p class="math-container">\[r_L \equiv \frac{v_\perp}{\omega_c} = \frac{mv_\perp}{|q| B}\]</p><p>Taking the real part of the positions, we have</p><p class="math-container">\[\begin{aligned}
x - x_0 = r_L\sin\omega_c t \\
y - y_0 = \pm r_L \cos\omega_c t
\end{aligned}\]</p><p>This describes a circular orbit about a <em>guiding center</em> (\( x<em>0, y</em>0 \)) which is fixed. The direction of the gyration is always such that the magnetic field generated by the charged particle is opposite to the externally imposed field. Plasma particles, therefore, tend to <em>reduce</em> the magnetic field, and plasmas are <em>diamagnetic</em>. In addition to this motion, there is an arbitrary velocity \( v_z \) along \( \mathbf{B} \) which is not affected by \( \mathbf{B} \). The trajectory of a charged particle in space is, in general, a helix.</p><h3 id="Finite-E"><a class="docs-heading-anchor" href="#Finite-E">Finite E</a><a id="Finite-E-1"></a><a class="docs-heading-anchor-permalink" href="#Finite-E" title="Permalink"></a></h3><p>If now we allow an electric field to be present, the motion will be found to be the sum of two motions: the usual circular Larmor gyration plus a drift of the guiding center. We may choose \( \mathbf{E} \) to lie in the x-z plane so that \( E_y = 0 \). As before, the z component of velocity is unrelated to the transverse components and can be treated separately. The equations of motion is now</p><p class="math-container">\[m\frac{d\mathbf{V}}{dt} = q( \mathbf{E} + \mathbf{V}\times\mathbf{B} )\]</p><p>whose z component is</p><p class="math-container">\[\frac{dv_z}{dt} = \frac{q}{m}E_z\]</p><p>or</p><p class="math-container">\[v_z = \frac{qE_z}{m}t + v_{z0}\]</p><p>This is a straightforward acceleration along \( \mathbf{B} \). The transverse components are</p><p class="math-container">\[\begin{aligned}
\frac{dv_x}{dt} = \frac{q}{m}E_x \pm \omega_c v_y \\
\frac{dv_y}{dt} = 0 \mp \omega_c v_x
\end{aligned}\]</p><h3 id="Gravitational-Field"><a class="docs-heading-anchor" href="#Gravitational-Field">Gravitational Field</a><a id="Gravitational-Field-1"></a><a class="docs-heading-anchor-permalink" href="#Gravitational-Field" title="Permalink"></a></h3><h2 id="Nonuniform-B-Field"><a class="docs-heading-anchor" href="#Nonuniform-B-Field">Nonuniform B Field</a><a id="Nonuniform-B-Field-1"></a><a class="docs-heading-anchor-permalink" href="#Nonuniform-B-Field" title="Permalink"></a></h2><h3 id="B-B:-Grad-B-Drift"><a class="docs-heading-anchor" href="#B-B:-Grad-B-Drift">∇B ⊥ B: Grad-B Drift</a><a id="B-B:-Grad-B-Drift-1"></a><a class="docs-heading-anchor-permalink" href="#B-B:-Grad-B-Drift" title="Permalink"></a></h3><h3 id="Curved-B:-Curvature-Drift"><a class="docs-heading-anchor" href="#Curved-B:-Curvature-Drift">Curved B: Curvature Drift</a><a id="Curved-B:-Curvature-Drift-1"></a><a class="docs-heading-anchor-permalink" href="#Curved-B:-Curvature-Drift" title="Permalink"></a></h3><h3 id="B-B:-Magnetic-Mirrors"><a class="docs-heading-anchor" href="#B-B:-Magnetic-Mirrors">∇B ∥ B: Magnetic Mirrors</a><a id="B-B:-Magnetic-Mirrors-1"></a><a class="docs-heading-anchor-permalink" href="#B-B:-Magnetic-Mirrors" title="Permalink"></a></h3><h2 id="Nonuniform-E-Field"><a class="docs-heading-anchor" href="#Nonuniform-E-Field">Nonuniform E Field</a><a id="Nonuniform-E-Field-1"></a><a class="docs-heading-anchor-permalink" href="#Nonuniform-E-Field" title="Permalink"></a></h2><h2 id="Time-Varying-E-Field"><a class="docs-heading-anchor" href="#Time-Varying-E-Field">Time-Varying E Field</a><a id="Time-Varying-E-Field-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Varying-E-Field" title="Permalink"></a></h2><h2 id="Time-Varying-B-Field"><a class="docs-heading-anchor" href="#Time-Varying-B-Field">Time-Varying B Field</a><a id="Time-Varying-B-Field-1"></a><a class="docs-heading-anchor-permalink" href="#Time-Varying-B-Field" title="Permalink"></a></h2><h2 id="Summary-of-Guiding-Center-Drifts"><a class="docs-heading-anchor" href="#Summary-of-Guiding-Center-Drifts">Summary of Guiding Center Drifts</a><a id="Summary-of-Guiding-Center-Drifts-1"></a><a class="docs-heading-anchor-permalink" href="#Summary-of-Guiding-Center-Drifts" title="Permalink"></a></h2><h2 id="Adiabatic-Invariants"><a class="docs-heading-anchor" href="#Adiabatic-Invariants">Adiabatic Invariants</a><a id="Adiabatic-Invariants-1"></a><a class="docs-heading-anchor-permalink" href="#Adiabatic-Invariants" title="Permalink"></a></h2><h3 id="The-First-Adiabatic-Invariant"><a class="docs-heading-anchor" href="#The-First-Adiabatic-Invariant">The First Adiabatic Invariant</a><a id="The-First-Adiabatic-Invariant-1"></a><a class="docs-heading-anchor-permalink" href="#The-First-Adiabatic-Invariant" title="Permalink"></a></h3><h3 id="The-Second-Adiabatic-Invariant"><a class="docs-heading-anchor" href="#The-Second-Adiabatic-Invariant">The Second Adiabatic Invariant</a><a id="The-Second-Adiabatic-Invariant-1"></a><a class="docs-heading-anchor-permalink" href="#The-Second-Adiabatic-Invariant" title="Permalink"></a></h3><h3 id="The-Third-Adiabatic-Invariant"><a class="docs-heading-anchor" href="#The-Third-Adiabatic-Invariant">The Third Adiabatic Invariant</a><a id="The-Third-Adiabatic-Invariant-1"></a><a class="docs-heading-anchor-permalink" href="#The-Third-Adiabatic-Invariant" title="Permalink"></a></h3></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../api/">« API</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.10 on <span class="colophon-date" title="Friday 24 December 2021 21:38">Friday 24 December 2021</span>. Using Julia version 1.7.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

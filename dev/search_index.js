var documenterSearchIndex = {"docs":
[{"location":"api/#Internal","page":"API","title":"Internal","text":"","category":"section"},{"location":"api/#Public-APIs","page":"API","title":"Public APIs","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Modules = [TestParticle]\nPrivate = false","category":"page"},{"location":"api/#TestParticle.prepare-Tuple{Any, Any, Any}","page":"API","title":"TestParticle.prepare","text":"prepare(E, B, F; species=Proton, q=1.0, m=1.0) -> (q, m, E, B, F)\n\nReturn a tuple consists of particle charge, mass for a prescribed species of charge q and mass m, analytic EM field functions, and external force F.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.prepare-Tuple{Any, Any}","page":"API","title":"TestParticle.prepare","text":"prepare(E, B; species=Proton, q=1.0, m=1.0) -> (q, m, E, B)\n\nReturn a tuple consists of particle charge, mass for a prescribed species of charge q and mass m and analytic EM field functions. Prescribed species are Electron and Proton; other species can be manually specified with species=Ion/User, q and m.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.prepare-Tuple{Meshes.CartesianGrid, Any, Any, Any}","page":"API","title":"TestParticle.prepare","text":"prepare(grid, E, B, F; species=Proton, q=1.0, m=1.0) -> (q, m, E, B, F)\n\nReturn a tuple consists of particle charge, mass for a prescribed species of charge q and mass m, analytic EM field functions, and external force F.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.prepare-Tuple{Meshes.CartesianGrid, Any, Any}","page":"API","title":"TestParticle.prepare","text":"prepare(grid, E, B; species=Proton) -> (q, m, E, B)\n\nReturn a tuple consists of particle charge, mass for a prescribed species and interpolated EM field functions.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.trace_analytic!-NTuple{4, Any}","page":"API","title":"TestParticle.trace_analytic!","text":"ODE equations for charged particle moving in static analytical EM field.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.trace_analytic_relativistic!-NTuple{4, Any}","page":"API","title":"TestParticle.trace_analytic_relativistic!","text":"ODE equations for relativistic charged particle moving in static analytical EM field.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.trace_numeric!-NTuple{4, Any}","page":"API","title":"TestParticle.trace_numeric!","text":"ODE equations for charged particle moving in static numerical EM field.\n\n\n\n\n\n","category":"method"},{"location":"api/#Private-types-and-methods","page":"API","title":"Private types and methods","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Modules = [TestParticle]\nPublic = false","category":"page"},{"location":"api/#TestParticle.Species","page":"API","title":"TestParticle.Species","text":"Type for the particles, Proton, Electron, Ion, or User.\n\n\n\n\n\n","category":"type"},{"location":"api/#TestParticle.dipole-Tuple{Any, Any}","page":"API","title":"TestParticle.dipole","text":"Calculates the magnetic field from a dipole with magnetic moment M at r.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.fieldline","page":"API","title":"TestParticle.fieldline","text":"fieldline(L, ϕ, nP)\n\nCreates points on one field line of the magnetic field from a dipole. In a centered dipole magnetic field model, the path along a given L shell can be described as r = L*cos²λ, where r is the radial distance (in planetary radii) to a point on the line, λ is its co-latitude, and L is the L-shell of interest.\n\n\n\n\n\n","category":"function"},{"location":"api/#TestParticle.getB_CS_harris-Tuple{Any, Any, Any}","page":"API","title":"TestParticle.getB_CS_harris","text":"getB_CS_harris(B₀, L)\n\nReturn the magnetic field at location r near a current sheet with magnetic strength B₀ and sheet length L.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.getB_bottle-NTuple{8, Any}","page":"API","title":"TestParticle.getB_bottle","text":"getB_bottle(x, y, z, distance, a, b, I1, I2) -> Vector{Float}\n\nGet magnetic field from a magnetic bottle. Reference: https://en.wikipedia.org/wiki/Magneticmirror#Magneticbottles\n\nArguments\n\nx,y,z::Float: location in [m].\ndistance::Float: distance between solenoids in [m].\na::Float: radius of each side coil in [m].\nb::Float: radius of central coil in [m].\nI1::Float: current in the solenoid times number of windings in side coils.\nI2::Float: current in the central solenoid times number of windings in the\n\ncentral loop.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.getB_dipole-Tuple{Any}","page":"API","title":"TestParticle.getB_dipole","text":"Analytic magnetic field function for testing. Return in SI unit.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.getB_tokamak-NTuple{7, Any}","page":"API","title":"TestParticle.getB_tokamak","text":"getB_tokamak(x, y, z, a, b, ICoils, IPlasma)\n\nGet the magnetic field from a Tokamak topology consists of 16 coils. Original: https://github.com/BoschSamuel/Simulation-of-a-Tokamak-Fusion-Reactor/blob/master/Simulation2.m\n\nArguments\n\nx,y,z::Float: location in [m].\na::Float: radius of each coil in [m].\nb::Float: radius of central region in [m].\nICoil::Float: current in the coil times number of windings.\nIPlasma::Float: current of the plasma?\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.getE_dipole-Tuple{Any}","page":"API","title":"TestParticle.getE_dipole","text":"Analytic electric field function for testing.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.set_axes_equal-Tuple{Any}","page":"API","title":"TestParticle.set_axes_equal","text":"set_axes_equal(ax)\n\nSet 3D plot axes to equal scale for Matplotlib. Make axes of 3D plot have equal scale so that spheres appear as spheres and cubes as cubes. Required since ax.axis('equal') and ax.set_aspect('equal') don't work on 3D.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.sph2cart-Tuple{Any, Any, Any}","page":"API","title":"TestParticle.sph2cart","text":"Convert from spherical to Cartesian coordinates vector.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.trace_analytic_full!-NTuple{4, Any}","page":"API","title":"TestParticle.trace_analytic_full!","text":"ODE equations for charged particle moving in static analytical EM field and external force field.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.trace_numeric_full!-NTuple{4, Any}","page":"API","title":"TestParticle.trace_numeric_full!","text":"ODE equations for charged particle moving in static numerical EM field and external force field.\n\n\n\n\n\n","category":"method"},{"location":"api/#TestParticle.trace_numeric_relativistic!-NTuple{4, Any}","page":"API","title":"TestParticle.trace_numeric_relativistic!","text":"ODE equations for relativistic charged particle moving in static numerical EM field.\n\n\n\n\n\n","category":"method"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = TestParticle","category":"page"},{"location":"#TestParticle.jl","page":"Home","title":"TestParticle.jl","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"TestParticle.jl is a test particle tracer in a static electromagnetic field.","category":"page"},{"location":"","page":"Home","title":"Home","text":"This package supports charged particle tracing in analytic/numerical relativistic/non-relativistic","category":"page"},{"location":"","page":"Home","title":"Home","text":"electric and magnetic field;\nbody force field.","category":"page"},{"location":"","page":"Home","title":"Home","text":"All tracing are performed in 3D, as is the nature for the fields. For a numerical field, the mesh is constructed with Meshes.jl, and the field is interpolated with the aid of Interpolations.jl. For an analytical field, the user is responsible for providing the function for calculating the field at a given spatial location. The actual tracing is done through DifferentialEquations.jl, thanks to the ODE system of the equations of motion.","category":"page"},{"location":"","page":"Home","title":"Home","text":"The single particle motions are the basics in understanding the test particle method. Check the complete tutorial taken from Chapter Two of Introduction to Plasma Physics by F.F.Chen.","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"] add TestParticle","category":"page"},{"location":"#Usage","page":"Home","title":"Usage","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"It would be better to understand the basic workflow of DifferentialEquations.jl before digging into TestParticle.jl. All we are doing here can be concluded as contructing the ODE system from Newton's 2nd law and preparing the field/particle data. Check more in Examples.","category":"page"},{"location":"#Acknowledgement","page":"Home","title":"Acknowledgement","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Nothing can be done such easily without the support of the Julia community. We appreciate all the contributions from developers around the world.","category":"page"},{"location":"tutorial/#Tutorial","page":"Tutorial","title":"Tutorial","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"What makes plasmas particularly difficult to analyze is the fact that the densities fall in an intermediate range. Fluids like water are so dense that the motions of individual molecules do not have to be considered. Collisions dominate, and the simple equations of ordinary fluid dynamics suffice. At the other extreme in very low-density devices, only single-particle trajectories need to be considered; collective effects are often unimportant. Plasma behaves sometimes like fluids, and sometimes like a collection of individual particles. The first step in learning how to deal with this schizophrenic personality is to understand how single particles behave in electric and magnetic fields.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Here we assume that the EM fields are prescribed and not affected by the charged particles. The materials here closely follows F.F.Chen's Introduction to Plasma Physics and Controlled Fusion.","category":"page"},{"location":"tutorial/#Uniform-E-and-B-Fields","page":"Tutorial","title":"Uniform E and B Fields","text":"","category":"section"},{"location":"tutorial/#E0","page":"Tutorial","title":"E=0","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"In this case, a charged particle has a simple cyclotron gyration. The equation of motion is","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mfracdmathbfVdt = qmathbfVtimesmathbfB","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Taking widehatz to be the direction of mathbfB (mathbfB = Bwidehatz), we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\nmdotv_x = qB v_y mdotv_y = -qB v_x mdotv_z = 0 \nddotv_x = fracqBmdotv_y = -big( fracqBmbig)^2 v_x \nddotv_y = fracqBmdotv_x = -big( fracqBmbig)^2 v_y\nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"This describes a simple harmonic oscillator at the cyclotron frequency, which we define to be","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"omega_c equiv frac q  Bms","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"By the convention we have chosen, omega_c is always nonnegative. The solution of velocity is then","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"v_xy = v_perp exp(pm i omega t + idelta_xy)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The pm denote the sign of q. We may choose the phase delta so that","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"v_x = v_perp e^iomega_c t = dotx","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"where v_perp is a positive constant denoting the speed in the plane perpendicular to mathbfB. Then","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"v_y  = fracmqB dotv_x = pm frac1omega_cdotv_x = pm i v_perp e^iomega_c t = doty","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Integrating once again, we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\nx - x_0 = -ifracv_perpomega_ce^iomega_c t \ny - y_0 = pm ifracv_perpomega_ce^iomega_c t\nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"We define the Larmor radius to be","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"r_L equiv fracv_perpomega_c = fracmv_perpq B","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Taking the real part of the positions, we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\nx - x_0 = r_Lsinomega_c t \ny - y_0 = pm r_L cosomega_c t  \nendaligned ","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"This describes a circular orbit about a guiding center (x_0 y_0) which is fixed. The direction of the gyration is always such that the magnetic field generated by the charged particle is opposite to the externally imposed field. Plasma particles, therefore, tend to reduce the magnetic field, and plasmas are diamagnetic. In addition to this motion, there is an arbitrary velocity v_z along mathbfB which is not affected by mathbfB. The trajectory of a charged particle in space is, in general, a helix.","category":"page"},{"location":"tutorial/#Finite-E","page":"Tutorial","title":"Finite E","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"If now we allow an electric field to be present, the motion will be found to be the sum of two motions: the usual circular Larmor gyration plus a drift of the guiding center. We may choose mathbfE to lie in the x-z plane so that E_y = 0. As before, the z component of velocity is unrelated to the transverse components and can be treated separately. The equations of motion is now","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mfracdmathbfVdt = q( mathbfE + mathbfVtimesmathbfB )","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"whose z component is","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"fracdv_zdt = fracqmE_z","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"or","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"v_z = fracqE_zmt + v_z0","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"This is a straightforward acceleration along mathbfB. The transverse components are","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\nfracdv_xdt = fracqmE_x pm omega_c v_y \nfracdv_ydt = 0 mp omega_c v_x\nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Differentiating, we have (for constant mathbfE)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\nddotv_x = -omega_c^2 v_x \nddotv_y = mp omega_c Big( fracqmE_x pm omega_c v_y Big) = -omega_c^2 Big( v_y + fracE_xB Big)\nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"We can write this as","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"fracd^2dt^2Big( v_y + fracE_xB Big) = -omega_c^2Big( v_y + fracE_xB Big)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"so that it reduces to the previous case if we replace v_y by v_y + (E_xB). The velocity solution is then replaced by","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\nv_x = v_perp e^iomega_c t \nv_y = pm v_perp e^iomega_c t - fracE_xB\nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The Larmor motion is the same as before, but there is superimposed a drift mathbfv_gc of the guiding center in the -y direction (for E_x  0).","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"To obtain a general formula for mathbfv_gc, we can solve the momentum equation in vector form. We may omit the m dmathbfvdt term, since this term gives only the circular motion at omega_c, which we already know about. Then the momeumtum equation becomes","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfE + mathbfvtimesmathbfB = 0","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Taking the cross product with mathbfB, we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfEtimesmathbfB = mathbfBtimes(mathbfvtimesmathbfB) = mathbfvB^2 - mathbfB(mathbfvcdotmathbfB)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The transverse components of this equation are","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_gc = mathbfEtimesmathbfBB^2 equiv mathbfv_E","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"We define this to be mathbfv_E, the electric field drift of the guiding center. In magnitude, this drift is","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"v_E = fracE(Vm)B(tesla)fracmsec","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"It is important to note that mathbfv_E is independent of q, m, and v_perp. The reason is obvious from the following physical picture. In the first half-cycle of the ion’s orbit, it gains energy from the electric field and increases in v_perp and, hence, in r_L. In the second half-cycle, it loses energy and decreases in r_L. This difference in r_L on the left and right sides of the orbit causes the drift v_E. A negative electron gyrates in the opposite direction but also gains energy in the opposite direction; it ends up drifting in the same direction as an ion. For particles of the same velocity but different mass, the lighter one will have smaller r_L and hence drift less per cycle. However, its gyration frequency is also larger, and the two effects exactly cancel. Two particles of the same mass but different energy would have the same omega_c. The slower one will have smaller r_L and hence gain less energy from mathbfE in a half-cycle. However, for less energetic particles the fractional change in r_L for a given change in energy is larger, and these two effects cancel.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The three-dimensional orbit in space is therefore a slanted helix with changing pitch.","category":"page"},{"location":"tutorial/#Gravitational-Field","page":"Tutorial","title":"Gravitational Field","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The foregoing result can be applied to other forces by replacing qmathbfE in the equation of motion by a general force mathbfF. The guiding center drift caused by mathbfF is then","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_f = frac1qfracmathbfFtimesmathbfBB^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"In particular, if mathbfF is the force of gravity mmathbfg, there is a drift","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_g = fracmqfracmathbfgtimesmathbfBB^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"This is similar to the drift mathbfv_E in that it is perpendicular to both the force and mathbfB, but it differs in one important respect. The drift mathbfv_g changes sign with the particle’s charge. Under a gravitational force, ions and electrons drift in opposite directions, so there is a net current density in the plasma given by","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfj = n(M+m)fracmathbfgtimesmathbfBB^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The physical reason for this drift is again the change in Larmor radius as the particle gains and loses energy in the gravitational field. Now the electrons gyrate in the opposite sense to the ions, but the force on them is in the same direction, so the drift is in the opposite direction. The magnitude of mathbfv_g is usually negligible, but when the lines of force (i.e. magnetic field lines) are curved, there is an effective gravitational force due to centrifugal force. This force, which is not negligible, is independent of mass; this is why we did not stress the m dependence of the drift here. Centrifugal force is the basis of a plasma instability called the “gravitational” instability, which has nothing to do with real gravity.","category":"page"},{"location":"tutorial/#Nonuniform-B-Field","page":"Tutorial","title":"Nonuniform B Field","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Now that the concept of a guiding center drift is firmly established, we can discuss the motion of particles in inhomogeneous fields — mathbfE and mathbfB fields which vary in space or time. For uniform fields we were able to obtain exact expressions for the guiding center drifts. As soon as we introduce inhomogeneity, the problem becomes too complicated to solve exactly. To get an approximate answer, it is customary to expand in the small ratio r_LL, where L is the scale length of the inhomogeneity. This type of theory, called orbit theory, can become extremely involved. We shall examine only the simplest cases, where only one inhomogeneity occurs at a time.","category":"page"},{"location":"tutorial/#B-B:-Grad-B-Drift","page":"Tutorial","title":"∇B ⊥ B: Grad-B Drift","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Here the magnetic field lines are straight, but their density increases, say, in the y direction. We can anticipate the result by using our simple physical picture. The gradient in |B| causes the Larmor radius to be larger at the bottom of the orbit than at the top, and this should lead to a drift, in opposite directions for ions and electrons, perpendicular to both B and nabla B. The drift velocity should obviously be proportional to r_LL and to v_perp.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Consider the Lorentz force mathbfF = qmathbfvtimesmathbfB, averaged over a gyration. Clearly, barF_x = 0, since the particle spends as much time moving up as down. We wish to calculate barF_y, in an approximate fashion, by using the undisturbed orbit of the particle to find the average. The undisturbed orbit is given by the solution in the first section for a uniform mathbfB field. Taking the real part of the solution for v_x and y, we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"F_y = -q v_x B_z(y) = -q v_perp(cos omega_c t) Big B_0 pm r_L(cosomega_c t )fracpartial Bpartial y Big","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"where we have made a Taylor expansion of mathbfB field about the point x_0=0 y_0=0","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\nmathbfB = mathbfB_0 + (mathbfrcdotnabla)mathbfB +  \nBz = B_0 + y(partial B_zpartial y) + \nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"This expansion of course requires r_L  L ll 1, where L is the length scale of partial Bzpartial y. The first term above averages to zero in a gyration, and the average of cos^2 omega_c t is 12, so that","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"barF_y = mp q v_perp r_L frac12fracpartial Bpartial y","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The guiding center drift velocity is then","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_gc = frac1qfracmathbfFtimesmathbfBB^2 = frac1qfracbarF_yBwidehatx = mp fracv_perp r_LBfrac12 fracpartial Bpartial y widehatx","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"where we have used the formula shown previously. Since the choice of the y axis was arbitrary, this can be generalized to","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_nabla B = pm v_perp r_L fracmathbfBtimes nabla BB^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"This has all the dependences we expected from the physical picture; only the factor frac12 (arising from the averaging) was not predicted. Note that the pm stands for the sign of the charge, and lightface B stands for B. The quantity mathbfv_nabla B is called the grad-B drift; it is in opposite directions for ions and electrons and causes a current transverse to mathbfB. An exact calculation of mathbfv_nabla B would require using the exact orbit, including the drift, in the averaging process.","category":"page"},{"location":"tutorial/#Curved-B:-Curvature-Drift","page":"Tutorial","title":"Curved B: Curvature Drift","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Here we assume the magnetic field lines to be curved with a constant radius of curvature R_c, and we take B to be constant. Such a field does not obey Maxwell’s equations in a vacuum, so in practice the grad-B drift will always be added to the effect derived here. A guiding center drift arises from the centrifugal force felt by the particles as they move along the field lines in their thermal motion. If v_parallel^2 denotes the average square of the component of random velocity along mathbfB, the average centrifugal force is","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfF_cf = fracmv_parallel^2R_cwidehatr = mv_parallel^2fracmathbfR_cR_c^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"According to the guiding center drift formula, this gives rise to a drift","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_R = frac1qfracmathbfF_cftimesmathbfBB^2 = fracmv_parallel^2qB^2fracmathbfR_c timesmathbfBR_c^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The drift mathbfv_R is called the curvature drift.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"We must now compute the grad-B drift which accompanies this when the decrease of B with radius is taken into account. In a vacuum, we have nablatimesmathbfB = 0. In the cylindrical coordinates, nablatimesmathbfB only has a z component, since mathbfB has only a theta component and nabla B only an r component. We then have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"(nablatimesmathbfB)_z = frac1rfracpartialpartial r(rB_theta) = 0 Bpropto frac1r","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Thus","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"B propto frac1R_c fracnabla BB = - fracmathbfR_cR_c^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Using the expression of the grad-B drift, we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_nabla B = mp frac12fracv_perp r_LB^2fracBtimes B fracmathbfR_cR_c^2 = pm frac12fracv_perp^2omega_cfracmathbfR_ctimesmathbfBR_c^2 B = frac12fracmqv_perp^2fracmathbfR_ctimesmathbfBR_c^2 B^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Adding this to mathbfv_R , we have the total drift in a curved vacuum field:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_R + mathbfv_nabla B = fracmqfracmathbfR_ctimesmathbfBR_c^2 B^2Big( v_parallel^2 + frac12v_perp^2 Big)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"It is unfortunate that these drifts add. This means that if one bends a magnetic field into a torus for the purpose of confining a thermonuclear plasma, the particles will drift out of the torus no matter how one juggles the temperatures and magnetic fields.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"For a Maxwellian distribution, barv_parallel^2 and frac12barv_perp^2 are each equal to k_B Tm, since v_perp involves two degrees of freedom. Then the average curved-field drift can be written as","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"barmathbfv_R+nabla B = pm fracv_th^2R_comega_cwidehaty = pmfracbarr_LR_cv_thwidehaty","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"where widehaty here is the direction of widehatR_ctimesmathbfB. This shows that barmathbfv_R+nabla B depends on the charge of the species but not on its mass.","category":"page"},{"location":"tutorial/#B-B:-Magnetic-Mirrors","page":"Tutorial","title":"∇B ∥ B: Magnetic Mirrors","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Now we consider a magnetic field which is pointed primarily in the z direction and whose magnitude varies in the z direction. Let the field be axisymmetric, with B_theta = 0 and partialpartialtheta = 0. Since the magnetic field lines converge and diverge, there is necessarily a component B_r. We wish to show that this gives rise to a force which can trap a particle in a magnetic field.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"We can obtain B_r from nablacdotmathbfB = 0:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"frac1rfracpartialpartial r(rB_r) + fracpartial B_zpartial z = 0","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"If partial mathbfB_zpartial z is given at r=0 and does not vary much with r, we have approximately","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\nrB_r = -int_0^r rfracpartial B_zpartial zdr simeq -frac12r^2 Big fracpartial mathbfB_zpartial z Big_r=0 \nB_r = -frac12r Big fracpartial mathbfB_zpartial z Big_r=0\nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The variation of B with r causes a grad-B drift of guiding centers about the axis of symmetry, but there is no radial grad-B drift, because partial Bpartial theta = 0. The components of the Lorentz force are","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\nF_r = q(underbracev_theta B_z_textcircledsmall1 - v_z cancelB_theta) \nF_theta = q(underbrace-v_r B_z_textcircledsmall2 + underbracev_z B_r_textcircledsmall3) \nF_z = q(v_r cancelB_theta - underbracev_theta B_r_textcircledsmall4)\nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Two terms vanish if B_theta = 0, and terms 1 and 2 give rise to the usual Larmor gyration. Term 3 vanishes on the axis; when it does not vanish, this azimuthal force causes a drift in the radial direction. This drift merely makes the guiding centers follow the magnetic field lines. Term 4 is the one we are interested in. Using the expression of B_r, we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"F_z = frac12q v_theta r_L fracpartial B_zpartial z","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"We must now average over one gyration. For simplicity, consider a particle whose guiding center lies on the axis. Then v_theta is a constant during a gyration; depending on the sign of q, v_theta is mp v_perp. Since r = r_L , the average force is","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"barF_z = mp frac12q v_perp r_L fracpartial B_zpartial z = mp frac12qfracv_perp^2omega_c fracpartial B_zpartial z = -frac12fracmv_perp^2B fracpartial B_zpartial z","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"We define the magnetic moment of the gyrating particle to be","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mu equiv frac12mv_perp^2  B","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"so that","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"barF_z = -mu fracpartial B_zpartial z","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"This is a specific example of the force on a diamagnetic particle, which in general can be written","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfF_parallel = -mufracpartial Bpartial mathbfs = -munabla_parallel B","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"where dmathbfs is a line element along mathbfB. Note that the definition of magnetic moment here is the same as the usual definition for the magnetic moment of a current loop with area A and current I: mu = IA. In the case of a singly charged ion, I is generated by a charge e coming around omega_c  2pi times a second: I = eomega_c2pi. The area A is pi r_L^2 = pi r_L^2omega_c^2. Thus","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mu = fraceomega_c2pifracpi r_L^2omega_c^2 = frac12fracv_perp^2 eomega_c = frac12fracmv_perp^2B","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"As the particle moves into regions of stronger or weaker B, its Larmor radius changes, but μ remains invariant. To prove this, consider the component of the equation of motion along mathbfB:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mfracdv_paralleldt = -mu fracpartial Bpartial s","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Multiplying by v_parallel on the left and its equivalent dsdt on the right, we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mv_parallel fracdv_paralleldt = fracddtBig( frac12mv_parallel^2 Big) = -mufracpartial Bpartial sfracdsdt = -mufracdBdt","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Here dB/dt is the variation of B as seen by the particle; B itself is constant. The particle’s energy must be conserved, so we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"fracddtBig( frac12mv_parallel^2 + frac12mv_perp^2 Big) = fracddtBig( frac12mv_parallel^2 + mu B Big) = 0","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"With the previous equation this becomes","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"-mufracdBdt + fracddt(mu B) = 0","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"so that","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"fracdmudt = 0","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The invariance of mu is the basis for one of the primary schemes for plasma confinement: the magnetic mirror. As a particle moves from a weak-field region to a strong-field region in the course of its thermal motion, it sees an increasing B, and therefore its v_perp must increase in order to keep μ constant. Since its total energy must remain constant, v_parallel must necessarily decrease. If B is high enough in the “throat” of the mirror, v_parallel eventually becomes zero; and the particle is “reflected” back to the weak-field region. It is, of course, the force mathbfF_parallel which causes the reflection. The nonuniform field of a simple pair of coil form two magnetic mirrors between which a plasma can be trapped. This effect works on both ions and electrons.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The trapping is not perfect, however. For instance, a particle with v_perp = 0 will have no magnetic moment and will not feel any force along mathbfB. A particle with small v_perp  v_parallel at the midplane (B = B_0) will also escape if the maximum field B_m is not large enough. For given B_0 and B_m, which particles will escape? A particle with v_perp = v_perp 0 and v_parallel = v_parallel 0 at the midplane will have v_perp = v_perp^prime and v_parallel = 0 at its turning point. Let the field be B^prime there. Then the invariants of mu yields ","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"frac12fracmv_perp 0^2B_0 = frac12fracmv_perp 0^prime^2B^prime","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Conservation of energy requires","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"v_perp 0^prime^2 = v_perp 0^2 + v_parallel 0^2 equiv v_0^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Combining the above two equations, we find","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"fracB_0B^prime = fracv_perp 0^2v_perp^prime^2 equiv sin^2 theta","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"where theta is the pitch angle of the orbit in the weak-field region. Particles with smaller θ will mirror in regions of higher B. If θ is too small, B^prime exceeds B_m; and the particles does not mirror at all. Replacing B^prime by B_m, we see that the smallest theta of a confined particle is given by","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"sin^2 theta_m = fracB_0B_m equiv frac1R_m","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"where R_m is the mirror ratio. It defines the boundary of a region in velocity space in the shape of a cone, called a loss cone. Particles lying within the loss cone are not confined. Consequently, a mirror-confined plasma is never isotropic. Note that the loss cone is independent of q or m. Without collisions, both ions and electrons are equally well confined. When collisions occur, particles are lost when they change their pitch angle in a collision and are scattered into the loss cone. Generally, electrons are lost more easily because they have a higher collision frequency.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The magnetic mirror was first proposed by Enrico Fermi as a mechanism for the acceleration of cosmic rays. Protons bouncing between magnetic mirrors approaching each other at high velocity could gain energy at each bounce. How such mirrors could arise is another story. A further example of the mirror effect is the confinement of particles in the Van Allen belts. The magnetic field of the earth, being strong at the poles and weak at the equator, forms a natural mirror with rather large R_m.","category":"page"},{"location":"tutorial/#Nonuniform-E-Field","page":"Tutorial","title":"Nonuniform E Field","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Now we let the magnetic field be uniform and the electric field be nonuniform. For simplicity, we assume mathbfE to be in the x direction and to vary sinusoidally in the x direction:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfE equiv E_0 (cos kx)widehatx","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"This field distribution has a wavelength lambda = 2pi  k, and is the result of a sinusoidal distribution of charges, which we need not specify. In practice, such a charge distribution can arise in a plasma during a wave motion. The equation of motion is","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mfracdmathbfvdt = qmathbfE(x) + mathbfvtimesmathbfB","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"whose transverse components are","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\ndotv_x = fracqBmv_y + fracqmE_x(x) \ndotv_y = -fracqBmv_x\nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\nddotv_x = -omega_c^2 v_x pm omega_c fracdotE_xB \nddotv_y = -omega_c^2 v_y -omega_c^2fracE_x(x)B\nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Here E_x(x) is the electric field at the position of the particle. To evaluate this, we need to know the particle’s orbit, which we are trying to solve for in the first place. If the electric field is weak, we may, as an approximation, use the undisturbed orbit to evaluate E_x(x). The orbit in the absence of the E field was given before","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"x = x_0 + r_Lsin omega_c t","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"so we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"ddotv_y = -omega_c^2 v_y -omega_c^2fracE_0Bcos k (x_0 + r_L sinomega_c t)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Anticipating the result, we look for a solution which is the sum of a gyration at omega_c and a steady drift mathbfv_E. Since we are interested in finding an expression for v_E, we take out the gyratory motion by averaging over a cycle. The v_x component then gives barv_x = 0.[question] In the v_y component, the oscillating term ddotv_y clearly averages to zero, and we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"[question]: I am kind of lost here. Probably the logic here is that first we assume the solution has an additional steady drift, so we let ddotv_y = 0? Check Y.Y's note.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"barddotv_y = 0 = -omega_c^2 barv_y -omega_c^2fracE_0Bbarcos k (x_0 + r_L sinomega_c t)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Expanding the cosine, we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"cos k (x_0 + r_L sinomega_c t) = cos(kx_0) cos(kr_L sinomega_c t) - sin(kx_0) sin(kr_L sinomega_c t)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"It will suffice to treat the small Larmor radius case, kr_L ll 1. The Taylor expansions allow us to write","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"cos k (x_0 + r_L sinomega_c t) approx cos(kx_0)big( 1 - frac12k^2r_L^2 sin^2omega_c t big) - sin(kx_0)k r_L sinomega_c t","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The last term vanishes upon averaging over time, and it gives","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"barv_y = -fracE_0Bcos(kx_0)big( 1 - frac14k^2r_L^2 big) = -fracE_x(x_0)Bbig( 1 - frac14k^2r_L^2 big)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Thus the usual mathbfEtimesmathbfB drift is modified by the inhomogeneity to read","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_E = fracmathbfEtimesmathbfBB^2big( 1 - frac14k^2r_L^2 big)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The physical reason for this is easy to see. An ion with its guiding center at a maximum of mathbfE actually spends a good deal of its time in regions of weaker mathbfE. Its average drift, therefore, is less than E/B evaluated at the guiding center. In a linearly varying mathbfE field, the ion would be in a stronger field on one side of the orbit and in a field weaker by the same amount on the other side; the correction to mathbfv_E then cancels out. From this it is clear that the correction term depends on the second derivative of mathbfE. For the sinusoidal distribution we assumed, the second derivative is always negative with respect to mathbfE. For an arbitrary variation of mathbfE, we need only replace ik by nabla and write the drift as","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_E = Big( 1 + frac14r_L^2nabla^2 Big) fracmathbfEtimesmathbfBB^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The second term is called the finite-Larmor-radius effect. What is the significance of this correction? Since r_L is much larger for ions than for electrons, mathbfv_E is no longer independent of species. If a density clump occurs in a plasma, an electric field can cause the ions and electrons to separate, generating another electric field. If there is a feedback mechanism that causes the second electric field to enhance the first one, mathbfE grows indefinitely, and the plasma is unstable. Such an instability, called a drift instability, is one type of plasma instabilities. The grad-B drift, of course, is also a finite-Larmor-radius effect and also causes charges to separate. However, mathbfv_nabla B propto kr_L whereas the correction term above is proportional to k^2 r_L^2. The nonuniform-E-field effect, therefore, is important at relatively large k, or small scale lengths of the inhomogeneity. For this reason, drift instabilities belong to a more general class called microinstabilities.","category":"page"},{"location":"tutorial/#Time-Varying-E-Field","page":"Tutorial","title":"Time-Varying E Field","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Let us now take mathbfE and mathbfB to be uniform in space but varying in time. First, consider the case in which mathbfE alone varies sinusoidally in time, and let it lie along the x axis:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfE = E_0 e^iomega twidehatx","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Since dotE_x = iomega E_x, we can write the velocity x-component equation as","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"ddotv_x = -omega_c^2 Big( v_x mp fraciomegaomega_cfractildeE_xB Big)","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Let us define","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\ntildev_p equiv pm fraciomegaomega_cfractildeE_xB \ntildev_E equiv fractildeE_xB\nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"where the tilde has been added merely to emphasize that the drift is oscillating. The plus (minus) sign, as usual, denotes positive (negative) q. Now the x and y velocity component equations can be written as","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\nddotv_x = -omega_c^2(v_x - tildev_p) \nddotv_y = -omega_c^2(v_y - tildev_E)\nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"By analogy with the derivation in the case of a uniform EM field, we try a solution which is the sum of a drift and a gyratory motion:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\nv_x = v_perp e^iomega_c t + tildev_p \nv_y = pm i v_perp e^iomega_c t + tildev_E\nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"If we now differentiate twice with respect to time, we find","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"beginaligned\nddotv_x = -omega_c^2 v_x + (omega_c^2 - omega^2)tildev_p \nddotv_y = -omega_c^2 v_y + (omega_c^2 - omega^2)tildev_E\nendaligned","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"This is not the same as the previous expressions right above unless omega^2 ll omega_c^2. If we now make the assumption that mathbfE varies slowly, so that omega^2 ll omega_c^2, then there we have the approximate solution.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The solution of velocities in x and y tells us that the guiding center motion has two components. The y component, perpendicular to mathbfB and mathbfE, is the usual mathbfEtimesmathbfB drift, except that v_E now oscillates slowly at the frequency omega. The x component, a new drift along the direction of mathbfE, is called the polarization drift. By replacing iomega with partialpartial t, we can generalize the expression of v_p and define the polarization drift as","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_p = pm frac1omega_c BfracdmathbfEdt","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Since mathbfv_p is in opposite directions for ions and electrons, there is a polarization current; for Z = 1, this is","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfj_p = ne(v_ip - v_ep) = fracneeB^2(M+m)fracdmathbfEdt = fracrhoBfracdmathbfEdt","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"where rho is the mass density.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The physical reason for the polarization current is simple. Consider an ion at rest in a magnetic field. If a field mathbfE is suddenly applied, the first thing the ion does is to move in the direction of mathbfE. Only after picking up a velocity mathbfv does the ion feel a Lorentz force emathbfvtimesmathbfB and begin to move perpendicular to both fields. If mathbfE is now kept constant, there is no further mathbfv_p drift but only a mathbfv_E drift. However, if mathbfE is reversed, there is again a momentary drift, this time to the left. Thus mathbfv_p is a startup drift due to inertia and occurs only in the first half-cycle of each gyration during which mathbfE changes. Consequently, mathbfv_p goes to zero when omegaomega_c ll 1.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The polarization effect in a plasma is similar to that in a solid dielectric, where mathbfD = epsilon_0mathbfE + mathbfP. The dipoles in a plasma are ions and electrons separated by a distance r_L. But since ions and electrons can move around to preserve quasineutrality, the application of a steady mathbfE field does not result in a polarization field mathbfP. However, if mathbfE oscillates, an oscillating current mathbfj_p results from the lag due to the ion inertia.","category":"page"},{"location":"tutorial/#Time-Varying-B-Field","page":"Tutorial","title":"Time-Varying B Field","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Finally, we allow the magnetic field to vary in time. Since the Lorentz force is always perpendicular to mathbfv, a magnetic field itself cannot impart energy to a charged particle. However, associated with mathbfB is an electric field given by","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"nablatimesmathbfE = -dotmathbfB","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"and this can accelerate the particles. We can no longer assume the fields to be completely uniform. Let mathbfv_perp = dmathbfldt be the transverse velocity, mathbfl being the element of the path along a particle trajectory (with v_parallel neglected). Taking the scalar product of the equation of motion with mathbfv_perp, we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"fracddtBig( frac12mv_perp^2 Big) = qmathbfEcdotmathbfv_perp = qmathbfEcdotfracdmathbfldt","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The change in one gyration is obtained by integrating over one period:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"delta Big( frac12mv_perp^2  Big) = int_0^2piomega_cqmathbfEcdotfracdmathbfldtdt","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"If the field changes slowly, we can replace the time integral by a line integral over the unperturbed orbit:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"delta Big( frac12mv_perp^2  Big) = oint qmathbfEcdot dmathbfl = qint_s (nablatimesmathbfE)cdot dmathbfS = -q int_sdotmathbfBcdot dmathbfS","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Here mathbfS is the surface enclosed by the Larmor orbit and has a direction given by the right-hand rule when the fingers point in the direction of mathbfv. Since the plasma is diamagnetic, we have mathbfBcdot dmathbfS0 for ions and mathbfBcdot dmathbfS0 for electrons. Then","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"delta Big( frac12mv_perp^2  Big) = pm q dotBpi r_L^2 = pm q pidotBfracv_perp^2omega_cfracmpm qB = fracfrac12mv_perp^2Bcdot frac2pi dotBomega_c","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The quantity frac2pidotBomega_c = fracdotBomega_c is just the change delta B during one period of gyration. Thus","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"delta Big( frac12mv_perp^2  Big) = mu delta B","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Since the left-hand-side is delta(mu B), we have the desired result","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"delta mu = 0","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The magnetic moment is invariant in slowly varying magnetic fields.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"As the B field varies in strength, the Larmor orbits expand and contract, and the particles lose and gain transverse energy. This exchange of energy between the particles and the field is described very simply by the invariant of magnetic moment. The invariance of mu allows us to prove easily the following well-known theorem:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The magnetic flux through a Larmor orbit is constant.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The flux Phi is given by BS, with S = pi r_L^2. Thus","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Phi = Bpifracv_perp^2omega_c^2 = Bpifracv_perp^2 m^2q^2 B^2 = frac2pi mq^2fracfrac12mv_perp^2B = frac2pi mq^2mu","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Therefore, Phi is constant if mu is constant.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"This property is used in a method of plasma heating known as adiabatic compression. A plasma is injected into a sequence of magnetic mirrors and by keep increasing the magnetic field in subsequent mirrors we can increase the plasma velocities.","category":"page"},{"location":"tutorial/#Summary-of-Guiding-Center-Drifts","page":"Tutorial","title":"Summary of Guiding Center Drifts","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"General force:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_f = frac1qfracmathbfFtimesmathbfBB^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Electric field:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_E = fracmathbfEtimesmathbfBB^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Gravitational field:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_g = fracmqfracmathbfgtimesmathbfBB^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Nonuniform electric field:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_E = Big( 1+frac14r_L^2 nabla^2 Big)fracmathbfEtimesmathbfBB^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Nonuniform magnetic field:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Grad-B:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_nabla B = pm frac12v_perp r_LfracmathbfBtimesnabla BB^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Curvature drift:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_R = fracmv_parallel^2qfracmathbfR_c timesmathbfBR_c^2 B^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Curved vacuum field:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_R + mathbfv_nabla B = fracmqBig( v_parallel^2 + frac12v_perp^2 Big) fracmathbfR_c timesmathbfBR_c^2 B^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Polarization drift:[^time-varying]","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_p = pm frac1omega_c BfracdmathbfEdt","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"[^time-varying]: In common test particle models, we assume static EM fields, so the polarization drift as well as adiabatic heating is not present. However, it is easily achieveable here in this package.","category":"page"},{"location":"tutorial/#Adiabatic-Invariants","page":"Tutorial","title":"Adiabatic Invariants","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"It is well known in classical mechanics that whenever a system has a periodic motion, the action integral oint p dq taken over a period is a constant of the motion. Here p and q are the generalized momentum and coordinate which repeat themselves in the motion. If a slow change is made in the system, so that the motion is not quite periodic, the constant of the motion does not change and is then called an adiabatic invariant. By slow here we mean slow compared with the period of motion, so that the integral oint p dq is well defined even though it is strictly no longer an integral over a closed path. Adiabatic invariants play an important role in plasma physics; they allow us to obtain simple answers in many instances involving complicated motions. There are three adiabatic invariants, each corresponding to a different type of periodic motion.","category":"page"},{"location":"tutorial/#The-First-Adiabatic-Invariant","page":"Tutorial","title":"The First Adiabatic Invariant","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"We have already met the quantity","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mu = mv_perp^2  2B","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"and have proved its invariance in spatially and temporally varying mathbfB fields. The periodic motion involved, of course, is the Larmor gyration. If we take p to be angular momentum mv_perp r and dq to be the coordinate dtheta, the action integral becomes","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"oint p dq = oint mv_perp r dtheta = 2pi r_L m v_perp = 2pi fracmv_perp^2omega_c = 4pi fracmqmu","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Thus μ is a constant of the motion as long as qm is not changed. We have proved the invariance of μ only with the implicit assumption omegaomega_c ll 1, where omega is a frequency characterizing the rate of change of mathbfB as seen by the particle. A proof exists, however, that μ is invariant even when omegaomega_c le q. In theorists’ language, μ is invariant “to all orders in an expansion in ω/ω c .” What this means in practice is that μ remains much more nearly constant than mathbfB does during one period of gyration.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"It is just as important to know when an adiabatic invariant does not exist as to know when it does. Adiabatic invariance of μ is violated when ω is not small compared with omega_c . We give three examples of this.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Magnetic Pumping. If the strength of mathbfB in a mirror confinement system is varied sinusoidally, the particles’ v_perp would oscillate; but there would be no gain of energy in the long run. However, if the particles make collisions, the","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"invariance of μ is violated, and the plasma can be heated. In particular, a particle making a collision during the compression phase can transfer part of its gyration energy into v_parallel energy, and this is not taken out again in the expansion phase.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Cyclotron Heating. Now imagine that the mathbfB field is oscillated at the frequency omega_c. The induced electric field will then rotate in phase with some of the particles and accelerate their Larmor motion continuously. The condition omegall omega_c is violated, μ is not conserved, and the plasma can be heated.\nMagnetic Cusps. If the current in one of the coils in a simple magnetic mirror system is reversed, a magnetic cusp is formed. This configuration has, in addition to the usual mirrors, a spindle-cusp mirror extending over 360^o in azimuth. A plasma confined in a cusp device is supposed to have better stability properties than that in an ordinary mirror. Unfortunately, the loss-cone losses are larger because of the additional loss region; and the particle motion is nonadiabatic. Since the mathbfB field vanishes at the center of symmetry, omega_c is zero there; and μ is not preserved. The local Larmor radius near the center is larger than the device. Because of this, the adiabatic invariant μ does not guarantee that particles outside a loss cone will stay outside after passing through the nonadiabatic region. Fortunately, there is in this case another invariant: the","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"canonical angular momentum p_theta = mrv_theta - erA_theta. This ensures that there will be a population of particles trapped indefinitely until they make a collision.","category":"page"},{"location":"tutorial/#The-Second-Adiabatic-Invariant","page":"Tutorial","title":"The Second Adiabatic Invariant","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Consider a particle trapped between two magnetic mirrors: it bounces between them and therefore has a periodic motion at the “bounce frequency”. A constant of this motion is given by oint mv_parallel ds, where ds is an element of path length (of the guiding center) along a field line. However, since the guiding center drifts across field lines, the motion is not exactly periodic, and the constant of the motion becomes an adiabatic invariant. This is called the longitudinal invariant J and is defined for a half-cycle between the two turning points","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"J = int_a^b v_parallel ds","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"We shall prove that J is invariant in a static, nonuniform B field; the result is also true for a slowly time-varying B field.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Before embarking on this somewhat lengthy proof, let us consider an example of the type of problem in which a theorem on the invariance of J would be useful. As we have already seen, the earth’s magnetic field mirror-traps charged particles, which slowly drift in longitude around the earth. If the magnetic field were perfectly symmetric, the particle would eventually drift back to the same magnetic field line. However, the actual field is distorted by such effects as the solar wind. In that case, will a particle ever come back to the same magnetic field line? Since the particle’s energy is conserved and is equal to frac12 mv_perp^2 at the turning point, the invariance of μ indicates that B remains the same at the turning point. However, upon drifting back to the same longitude, a particle may find itself on another magnetic field line at a different altitude. This cannot happen if J is conserved. J determines the length of the field lines between turning points, and no two lines have the same length between points with the same B. Consequently, the particle returns to the same magnetic field line even in a slightly asymmetric field.","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"To prove the invariance of J, we first consider the invariance of v_parallel delta s, where delta s is a segment of the path along mathbfB. Because of guiding center drifts, a particle on s will find itself on another magnetic field line delta s^prime after a time Delta t. The length of delta s^prime is defined by passing planes perpendicular to mathbfB through the end points of delta s. The length of delta s is obviously proportional to the radius of curvature:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"fracdelta sR_c = fracdelta s^primeR_c^prime","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"so that","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"fracdelta s^prime - delta sDelta t delta s = fracR_c^prime - R_cDelta t R_c","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The \"radial\" component of mathbfv_gc is just","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_gccdot fracmathbfR_cR_c = fracR_c^prime - R_cDelta t","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The guiding center drift in curved vacuum field is","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"mathbfv_gc = mathbfv_R + mathbfv_nabla B = pm frac12v_perp r_LfracmathbfBtimesnabla BB^2 + fracmv_parallel^2qfracmathbfR_c timesmathbfBR_c^2 B^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The curvature drift has no component along mathbfR_c. Using the above three equations, we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"frac1delta sfracddtdelta s = mathbfv_gs cdot fracmathbfR_cR_c^2 = frac12fracmqfracv_perp^2B^3(mathbfBtimesnabla B)cdotfracmathbfR_cR_c^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"This is the rate of change of delta s as seen by the particle. We must now get the rate of change of v_parallel as seen by the particle. The parallel and perpendicular energies are defined by","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"W equiv frac12mv_parallel^2 + frac12mv_parallel^2 = frac12mv_parallel^2 + mu B equiv W_parallel + W_perp","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Thus v_parallel can be written","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"v_parallel = big frac2m(W - mu B) big^12","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Here W and μ are constant, and only B varies. Therefore,","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"fracdotv_parallelv_parallel = -frac12fracmudotBW - mu B = -frac12fracmu dotBW_parallel = -fracmudotBmv_parallel^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Since B was assumed static, dotB is not zero only because of the guiding center motion:","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"dotB = fracdBdmathbfrcdotfracdmathbfrdt = mathbfv_gccdotnabla B = fracmv_parallel^2qfracmathbfR_c timesmathbfBR_c^2 B^2 cdotnabla B ","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Now we have","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"fracdotv_parallelv_parallel = -fracmuqfrac(mathbfR_ctimesmathbfB)cdotnabla BR_c^2 B^2 = -frac12fracmqfracv_perp^2B frac(mathbfR_ctimesmathbfB)cdotnabla BR_c^2 B^2","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"The fractional change in v_parallel delta s is","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"frac1v_parallel delta sfracddt(v_parallel delta s) = frac1delta sfracddelta sdt + frac1v_parallelfracdv_paralleldt","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"From the previous derivations we see that the these two terms cancel, so that","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"v_parallel delta s = textrmconstant","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"This is not exactly the same as saying that J is constant, however. In taking the integral of v_parallel delta s, between the turning points, it may be that the turning points on delta s^prime do not coincide with the intersections of the perpendicular planes. However, any error in J arising from such a discrepancy is negligible because near the turning points, v_parallel is nearly zero. Consequently, we have proved","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"J = int_a^b v_parallel ds = textrmconstant","category":"page"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"An example of the violation of J invariance is given by a plasma heating scheme called transit-time magnetic pumping. Suppose an oscillating current is applied to the coils of a mirror system so that the mirrors alternately approach and withdraw from each other near the bounce frequency. Those particles that have the right bounce frequency will always see an approaching mirror and will therefore gain v_parallel. J is not conserved in this case because the change of mathbfB occurs on a time scale not long compared with the bounce time.","category":"page"},{"location":"tutorial/#The-Third-Adiabatic-Invariant","page":"Tutorial","title":"The Third Adiabatic Invariant","text":"","category":"section"},{"location":"tutorial/","page":"Tutorial","title":"Tutorial","text":"Referring again to the earth dipole case, we see that the slow drift of a guiding center around the earth constitutes a third type of periodic motion. The adiabatic invariant connected with this turns out to be the total magnetic flux Phi enclosed by the drift surface. It is almost obvious that, as mathbfB varies, the particle will stay on a surface such that the total number of magnetic field lines enclosed remains constant. This invariant, Phi, has few applications because most fluctuations of mathbfB occur on a time scale short compared with the drift period. As an example of the violation of Phi invariance, we can cite some recent work on the excitation of hydromagnetic waves in the ionosphere. These waves have a long period comparable to the drift time of a particle around the earth. The particles can therefore encounter the wave in the same phase each time around. If the phase is right, the wave can be excited by the conversion of particle drift energy to wave energy.","category":"page"},{"location":"example/#Examples","page":"Example","title":"Examples","text":"","category":"section"},{"location":"example/","page":"Example","title":"Example","text":"Multiple demonstrations are provided. For all the tracing methods, we provide both an inplace version (with ! at the end of the function name) and a non-inplace version using StaticArrays. The non-inplace version requires the initial conditions to be static a static vector. Use them at your convenience.","category":"page"},{"location":"example/#Choice-of-numerical-algorithm","page":"Example","title":"Choice of numerical algorithm","text":"","category":"section"},{"location":"example/","page":"Example","title":"Example","text":"By default DifferentialEquations.jl applies Tsit5 to an ODE problem. However, it is not always guaranteed to work. For example, the demo case of electron tracing in the magnetic bottle with strong magnetic field is tested to work only with fixed timestep algorithms like Euler and the Adams-Bashforth family. Take you some time to figure out which algorithm works for your problem!","category":"page"},{"location":"example/#Gallery","page":"Example","title":"Gallery","text":"","category":"section"},{"location":"example/","page":"Example","title":"Example","text":"Tracing proton in a uniform EM field","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: )","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"The electric field is parallel to the magnetic field in z direction, so the motion consists of a cyclotron gyration and an acceleration along z.","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Tracing electrons in a uniform EM field","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: )","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Tracing electron and proton in the same uniform EM field (real physical parameters), source","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: )","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Due to the fact that m_p  m_e doteq 1836, the proton gyro-radius is 1800 times larger than the electron, if they start with the same velocity as in this case. In more common cases we would compare electrons and protons with the same energy, and their gyro-radii differ by a factor of sqrtm_pm_e sim 40.","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Tracing in a magnetic dipole field corresponds to a Harris current sheet with strength 20 nT and width 0.4 Re for protons at 50 keV, source","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: )","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Tracing in a Earth-like magnetic dipole field for protons at 50 keV, source","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: )","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"This is a combination of grad-B drift, curvature drift, and the bounce motion between mirror points.","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Tracing relativistic electron close to the speed of light in a magnetic bottle, source","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: )","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Tracing relativistic proton in a Tokamak[1]","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: ), source","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"As you can see from the trajectory, this proton will escape after a certain time.","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"[1]: A excellent introduction video to Tokamak can be found here in Mandarin.","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"Tracing protons in the simulated EM field near Ganymede from MHD-EPIC","category":"page"},{"location":"example/","page":"Example","title":"Example","text":"(Image: )","category":"page"}]
}
